stages:
  - commit-phase
  - report-phase
  - uat-phase
  - pat-phase
  - sat-phase
  - deploy-phase

lintFrontend:
  stage: commit-phase
  tags:
    - npm
  script:
    - cd frontend/myCargonaut
    - npm install
    - npm run lint
  allow_failure: false

lintBackend:
  stage: commit-phase
  tags:
    - npm
  script:
    - cd backend
    - npm install
    - npx eslint .
  allow_failure: false

testFrontend:
  stage: commit-phase
  tags:
    - npm
  script:
    - cd frontend/myCargonaut
    - npm i
    - echo 'TestFramework under construction...'
  allow_failure: true

testBackend:
  stage: commit-phase
  tags:
    - npm
  script:
    - cd backend
    - npm i
    - npm run test
  allow_failure: true

static_code_analysis:
  stage: report-phase
  image:
    name: sonarsource/sonar-scanner-cli:latest
    entrypoint: [""]
  tags:
    - KMS
  script:
    - echo 'Running static code analysis...'
    - sonar-scanner
      -Dsonar.host.url=https://scm.thm.de/sonar
      -Dsonar.projectKey=$SONARQUBE_KEY
      -Dsonar.login=$SONARQUBE_TOKEN
